{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "df-bi-ewa"
		},
		"Staging Account_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Staging Account'"
		},
		"CSS Production_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CSS Production'"
		},
		"CSS_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CSS'"
		},
		"DDI_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'DDI'"
		},
		"EWA_Staging_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'EWA_Staging'"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Staging Account')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('Staging Account_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/EWA-PRDW01-IR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/EWA-PRSQL01-IR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"description": "Reporting Server - Development Server",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IGA-IR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Staging Account",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FileNameStaging": {
						"type": "string"
					}
				},
				"folder": {
					"name": "02 - Staging"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat(dataset().FileNameStaging,'.csv')",
							"type": "Expression"
						},
						"container": "adf-staging"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "USUARIO",
						"type": "String"
					},
					{
						"name": "F_ACTUAL",
						"type": "String"
					},
					{
						"name": "PROGRAMA",
						"type": "String"
					},
					{
						"name": "COD_CLI",
						"type": "String"
					},
					{
						"name": "APE1_CLI",
						"type": "String"
					},
					{
						"name": "APE2_CLI",
						"type": "String"
					},
					{
						"name": "NOM_CLI",
						"type": "String"
					},
					{
						"name": "TFNO_CLI",
						"type": "String"
					},
					{
						"name": "COD_CALLE",
						"type": "String"
					},
					{
						"name": "NUM_PUERTA",
						"type": "String"
					},
					{
						"name": "DUPLICADOR",
						"type": "String"
					},
					{
						"name": "CGV_CLI",
						"type": "String"
					},
					{
						"name": "DOC_ID",
						"type": "String"
					},
					{
						"name": "TIP_DOC",
						"type": "String"
					},
					{
						"name": "CO_PAIS",
						"type": "String"
					},
					{
						"name": "TIP_CLI",
						"type": "String"
					},
					{
						"name": "F_ALTA",
						"type": "String"
					},
					{
						"name": "F_BAJA",
						"type": "String"
					},
					{
						"name": "NRH",
						"type": "String"
					},
					{
						"name": "NRH_FAV",
						"type": "String"
					},
					{
						"name": "NRH_PEN",
						"type": "String"
					},
					{
						"name": "FAX_CLI",
						"type": "String"
					},
					{
						"name": "PERS_CONTACTO",
						"type": "String"
					},
					{
						"name": "CO_COND_FISCAL",
						"type": "String"
					},
					{
						"name": "SOUNDEX_AP1",
						"type": "String"
					},
					{
						"name": "SOUNDEX_AP2",
						"type": "String"
					},
					{
						"name": "REF_DIR",
						"type": "String"
					},
					{
						"name": "CUALIF_CLI",
						"type": "String"
					},
					{
						"name": "NUM_DEV_CHEQ",
						"type": "String"
					},
					{
						"name": "CANT_LETRAS_IMPAGAS",
						"type": "String"
					},
					{
						"name": "NUM_FISCAL",
						"type": "String"
					},
					{
						"name": "APE1_CLI_UP",
						"type": "String"
					},
					{
						"name": "DATOS",
						"type": "String"
					},
					{
						"name": "COD_POST",
						"type": "String"
					},
					{
						"name": "NIF",
						"type": "String"
					},
					{
						"name": "TFNO2_CLI",
						"type": "String"
					},
					{
						"name": "DATOS2",
						"type": "String"
					},
					{
						"name": "EST_CLI",
						"type": "String"
					},
					{
						"name": "SPEC_SIGNAL",
						"type": "String"
					},
					{
						"name": "APE3_CLI",
						"type": "String"
					},
					{
						"name": "APE1_CLI_ARAB",
						"type": "String"
					},
					{
						"name": "APE2_CLI_ARAB",
						"type": "String"
					},
					{
						"name": "APE3_CLI_ARAB",
						"type": "String"
					},
					{
						"name": "NOM_CLI_ARAB",
						"type": "String"
					},
					{
						"name": "APE1_CLI_ARAB_UP",
						"type": "String"
					},
					{
						"name": "IND_CASH_ONLY",
						"type": "String"
					},
					{
						"name": "COD_RATING",
						"type": "String"
					},
					{
						"name": "F_RATING",
						"type": "String"
					},
					{
						"name": "PASSPORT_NO",
						"type": "String"
					},
					{
						"name": "JOB_TITLE",
						"type": "String"
					},
					{
						"name": "NIF_WORK",
						"type": "String"
					},
					{
						"name": "F_BIRTH",
						"type": "String"
					},
					{
						"name": "TFNO3_CLI",
						"type": "String"
					},
					{
						"name": "EMAIL",
						"type": "String"
					},
					{
						"name": "OBSERVACIONES",
						"type": "String"
					},
					{
						"name": "PASSWORD",
						"type": "String"
					},
					{
						"name": "F_CASH_ONLY",
						"type": "String"
					},
					{
						"name": "EMAIL2",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Staging Account')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/StagingWithoutFileName')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Staging Account",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "02 - Staging"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "adf-staging"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Staging Account')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSS Production')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('CSS Production_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IGA-IR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IGA-IR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSS')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('CSS_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IGA-IR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IGA-IR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DDI')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('DDI_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IGA-IR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IGA-IR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EWA_Staging')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('EWA_Staging_connectionString')]"
				},
				"connectVia": {
					"referenceName": "EWA-PRDW01-IR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/EWA-PRDW01-IR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Destination')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EWA_Staging",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableNameDestination": {
						"type": "string"
					},
					"TableSchemaDestination": {
						"type": "string"
					}
				},
				"folder": {
					"name": "03 - Destinations"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "USUARIO",
						"type": "nvarchar"
					},
					{
						"name": "F_ACTUAL",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "PROGRAMA",
						"type": "nvarchar"
					},
					{
						"name": "COD_CLI",
						"type": "float",
						"precision": 15
					},
					{
						"name": "APE1_CLI",
						"type": "nvarchar"
					},
					{
						"name": "APE2_CLI",
						"type": "nvarchar"
					},
					{
						"name": "NOM_CLI",
						"type": "nvarchar"
					},
					{
						"name": "TFNO_CLI",
						"type": "nvarchar"
					},
					{
						"name": "COD_CALLE",
						"type": "float",
						"precision": 15
					},
					{
						"name": "NUM_PUERTA",
						"type": "float",
						"precision": 15
					},
					{
						"name": "DUPLICADOR",
						"type": "nvarchar"
					},
					{
						"name": "CGV_CLI",
						"type": "nvarchar"
					},
					{
						"name": "DOC_ID",
						"type": "nvarchar"
					},
					{
						"name": "TIP_DOC",
						"type": "nvarchar"
					},
					{
						"name": "CO_PAIS",
						"type": "nvarchar"
					},
					{
						"name": "TIP_CLI",
						"type": "nvarchar"
					},
					{
						"name": "F_ALTA",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "F_BAJA",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "NRH",
						"type": "float",
						"precision": 15
					},
					{
						"name": "NRH_FAV",
						"type": "float",
						"precision": 15
					},
					{
						"name": "NRH_PEN",
						"type": "float",
						"precision": 15
					},
					{
						"name": "FAX_CLI",
						"type": "float",
						"precision": 15
					},
					{
						"name": "PERS_CONTACTO",
						"type": "float",
						"precision": 15
					},
					{
						"name": "CO_COND_FISCAL",
						"type": "nvarchar"
					},
					{
						"name": "SOUNDEX_AP1",
						"type": "nvarchar"
					},
					{
						"name": "SOUNDEX_AP2",
						"type": "nvarchar"
					},
					{
						"name": "REF_DIR",
						"type": "nvarchar"
					},
					{
						"name": "CUALIF_CLI",
						"type": "nvarchar"
					},
					{
						"name": "NUM_DEV_CHEQ",
						"type": "float",
						"precision": 15
					},
					{
						"name": "CANT_LETRAS_IMPAGAS",
						"type": "float",
						"precision": 15
					},
					{
						"name": "NUM_FISCAL",
						"type": "nvarchar"
					},
					{
						"name": "APE1_CLI_UP",
						"type": "nvarchar"
					},
					{
						"name": "DATOS",
						"type": "nvarchar"
					},
					{
						"name": "COD_POST",
						"type": "nvarchar"
					},
					{
						"name": "NIF",
						"type": "float",
						"precision": 15
					},
					{
						"name": "TFNO2_CLI",
						"type": "nvarchar"
					},
					{
						"name": "DATOS2",
						"type": "nvarchar"
					},
					{
						"name": "EST_CLI",
						"type": "nvarchar"
					},
					{
						"name": "SPEC_SIGNAL",
						"type": "nvarchar"
					},
					{
						"name": "APE3_CLI",
						"type": "nvarchar"
					},
					{
						"name": "APE1_CLI_ARAB",
						"type": "nvarchar"
					},
					{
						"name": "APE2_CLI_ARAB",
						"type": "nvarchar"
					},
					{
						"name": "APE3_CLI_ARAB",
						"type": "nvarchar"
					},
					{
						"name": "NOM_CLI_ARAB",
						"type": "nvarchar"
					},
					{
						"name": "APE1_CLI_ARAB_UP",
						"type": "nvarchar"
					},
					{
						"name": "IND_CASH_ONLY",
						"type": "float",
						"precision": 15
					},
					{
						"name": "COD_RATING",
						"type": "nvarchar"
					},
					{
						"name": "F_RATING",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "PASSPORT_NO",
						"type": "nvarchar"
					},
					{
						"name": "JOB_TITLE",
						"type": "nvarchar"
					},
					{
						"name": "NIF_WORK",
						"type": "float",
						"precision": 15
					},
					{
						"name": "F_BIRTH",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TFNO3_CLI",
						"type": "nvarchar"
					},
					{
						"name": "EMAIL",
						"type": "nvarchar"
					},
					{
						"name": "OBSERVACIONES",
						"type": "nvarchar"
					},
					{
						"name": "PASSWORD",
						"type": "nvarchar"
					},
					{
						"name": "F_CASH_ONLY",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "EMAIL2",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": {
						"value": "@dataset().TableSchemaDestination",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableNameDestination",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/EWA_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GetMaxDate')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EWA_Staging",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "00-Configuration"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/EWA_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/IsDestinationTableExists')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EWA_Staging",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "00-Configuration"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/EWA_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Source')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CSS",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableNameSource": {
						"type": "string"
					},
					"TableSchemaSource": {
						"type": "string"
					}
				},
				"folder": {
					"name": "01 - Sources"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().TableSchemaSource",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableNameSource",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/CSS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceTables')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EWA_Staging",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "00-Configuration"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "TableSchemaSource",
						"type": "nvarchar"
					},
					{
						"name": "TableNameSource",
						"type": "nvarchar"
					},
					{
						"name": "FileNameStaging",
						"type": "nvarchar"
					},
					{
						"name": "TableSchemaDestination",
						"type": "nvarchar"
					},
					{
						"name": "TableNameDestination",
						"type": "nvarchar"
					},
					{
						"name": "Order",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProcessGUID",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "vw_Configuration.SourceTables"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/EWA_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TableSourceSchema')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CSS",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "01 - Sources"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/CSS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TableSourceSchemaDestination')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "EWA_Staging",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "03 - Destinations"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "COLUMN_NAME",
						"type": "nvarchar"
					},
					{
						"name": "DATA_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "DATA_LENGTH",
						"type": "int",
						"precision": 10
					},
					{
						"name": "NULLABLE",
						"type": "nvarchar"
					},
					{
						"name": "COLUMN_ID",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Configuration.SourceTableSchema"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/EWA_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Data Flow Count')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Staging",
								"type": "DatasetReference"
							},
							"name": "Source"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "StagingWithoutFileName",
								"type": "DatasetReference"
							},
							"name": "Destination"
						}
					],
					"transformations": [
						{
							"name": "Count"
						}
					],
					"script": "source(output(\n\t\tUSUARIO as string,\n\t\tF_ACTUAL as string,\n\t\tPROGRAMA as string,\n\t\tCOD_CLI as string,\n\t\tAPE1_CLI as string,\n\t\tAPE2_CLI as string,\n\t\tNOM_CLI as string,\n\t\tTFNO_CLI as string,\n\t\tCOD_CALLE as string,\n\t\tNUM_PUERTA as string,\n\t\tDUPLICADOR as string,\n\t\tCGV_CLI as string,\n\t\tDOC_ID as string,\n\t\tTIP_DOC as string,\n\t\tCO_PAIS as string,\n\t\tTIP_CLI as string,\n\t\tF_ALTA as string,\n\t\tF_BAJA as string,\n\t\tNRH as string,\n\t\tNRH_FAV as string,\n\t\tNRH_PEN as string,\n\t\tFAX_CLI as string,\n\t\tPERS_CONTACTO as string,\n\t\tCO_COND_FISCAL as string,\n\t\tSOUNDEX_AP1 as string,\n\t\tSOUNDEX_AP2 as string,\n\t\tREF_DIR as string,\n\t\tCUALIF_CLI as string,\n\t\tNUM_DEV_CHEQ as string,\n\t\tCANT_LETRAS_IMPAGAS as string,\n\t\tNUM_FISCAL as string,\n\t\tAPE1_CLI_UP as string,\n\t\tDATOS as string,\n\t\tCOD_POST as string,\n\t\tNIF as string,\n\t\tTFNO2_CLI as string,\n\t\tDATOS2 as string,\n\t\tEST_CLI as string,\n\t\tSPEC_SIGNAL as string,\n\t\tAPE3_CLI as string,\n\t\tAPE1_CLI_ARAB as string,\n\t\tAPE2_CLI_ARAB as string,\n\t\tAPE3_CLI_ARAB as string,\n\t\tNOM_CLI_ARAB as string,\n\t\tAPE1_CLI_ARAB_UP as string,\n\t\tIND_CASH_ONLY as string,\n\t\tCOD_RATING as string,\n\t\tF_RATING as string,\n\t\tPASSPORT_NO as string,\n\t\tJOB_TITLE as string,\n\t\tNIF_WORK as string,\n\t\tF_BIRTH as string,\n\t\tTFNO3_CLI as string,\n\t\tEMAIL as string,\n\t\tOBSERVACIONES as string,\n\t\tPASSWORD as string,\n\t\tF_CASH_ONLY as string,\n\t\tEMAIL2 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> Source\nSource aggregate(groupBy(PASSWORD),\n\tCount = count()) ~> Count\nCount sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['CountImp'],\n\tpartitionBy('hash', 1)) ~> Destination"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Staging')]",
				"[concat(variables('factoryId'), '/datasets/StagingWithoutFileName')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceDDI')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DDI",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableNameSource": {
						"type": "string"
					},
					"TableSchemaSource": {
						"type": "string"
					}
				},
				"folder": {
					"name": "01 - Sources"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().TableSchemaSource",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().TableNameSource",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DDI')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TableSourceSchemaDDI')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DDI",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "01 - Sources"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DDI')]"
			]
		}
	]
}